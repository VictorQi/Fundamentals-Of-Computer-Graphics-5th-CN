# 2 - 数学基础

图形学很大程度上就是将数学直接转换成代码。数学越简洁，最终的代码就越清晰；因此本书很大一部分内容专注于为每个任务选择最合适的数学工具。本章回顾了高中和大学数学中的各种工具，设计初衷更多是作为参考资料而非教程。本章看起来可能像是各种主题的大杂烩，事实上也确实如此；选择每个主题都有其原因：要么是因为它在"标准"数学课程中有些不常见，要么是因为它在图形学中具有核心重要性，或者是因为它通常不会从几何角度来讲解。除了建立本书所使用符号记法的回顾之外，本章还强调了一些在标准本科课程中有时会被跳过的要点，例如三角形上的重心坐标。本章并不旨在对这些材料进行严格的理论处理；相反，重点强调直觉理解和几何解释。线性代数的讨论推迟到第6章，就在讨论变换矩阵之前。建议读者浏览本章以熟悉所涵盖的主题，并在需要时回过头来参考。本章末尾的练习题可能有助于确定哪些主题需要复习。

## 2.1 集合和映射

映射（也称为函数）是数学和编程的基础。就像程序中的函数一样，数学中的映射接受某种类型的参数，并将其映射到（返回）特定类型的对象。在程序中，我们称之为"类型"；在数学中，我们会明确指出集合。当我们有一个对象是某个集合的成员时，我们使用符号 $\in$。例如，

$$a \in S$$

可以读作"$a$ 是集合 $S$ 的成员"。给定任意两个集合 $A$ 和 $B$，我们可以通过取两个集合的笛卡尔积来创建第三个集合，记作 $A \times B$。这个集合 $A \times B$ 由所有可能的有序对 $(a,b)$ 组成，其中 $a \in A$ 且 $b \in B$。作为简写，我们使用记号 $A^2$ 来表示 $A \times A$。我们可以扩展笛卡尔积的概念，从三个集合创建所有可能的有序三元组的集合，依此类推，可以从任意多个集合得到任意长度的有序元组。

常用的集合包括：

• $\mathbb{R}$ —— 实数集；
• $\mathbb{R}^+$ —— 非负实数集（包括零）；
• $\mathbb{R}^2$ —— 实数平面上的有序对；
• $\mathbb{R}^n$ —— $n$ 维笛卡尔空间中的点；
• $\mathbb{Z}$ —— 整数集；
• $S^2$ —— 单位球面上的三维点集（$\mathbb{R}^3$ 中的点）。

注意，虽然 $S^2$ 由嵌入在三维空间中的点组成，但它位于可以用两个变量参数化的曲面上，因此可以将其视为二维集合。

映射的记号使用箭头和冒号，例如：

$$f : \mathbb{R} \to \mathbb{Z}$$

可以读作"存在一个名为 $f$ 的函数，它以实数作为输入并将其映射到整数"。这里，箭头前面的集合称为函数的**定义域**，右侧的集合称为**目标集**。计算机程序员可能更习惯以下等价的表述："存在一个名为 $f$ 的函数，它有一个实数参数并返回一个整数"。换句话说，上述集合记号等价于常见的编程记号：

```text
integer f(real) ← 等价于 → f : ℝ → ℤ
```

因此，冒号-箭头记号可以视为一种编程语法。就是这么简单。

点 $f(a)$ 被称为 $a$ 的**像**，而集合 $A$（定义域的一个子集）的像是目标集的子集，它包含 $A$ 中所有点的像。整个定义域的像被称为函数的**值域**。

### 2.1.1 逆映射

![Figure2.1](pic/Figure2.1.png)
如果我们有一个函数 $f : A \to B$，可能存在一个逆函数 $f^{-1}: B \to A$，其定义规则为 $f^{-1}(b) = a$，其中 $b = f(a)$。这个定义只有在以下条件下才有效：$B$ 中的每个 $b$ 都是某个点在 $f$ 下的像（即值域等于目标集），并且只有唯一的一个这样的点（即只有唯一的 $a$ 使得 $f(a) = b$）。这样的映射或函数被称为**双射**。双射将 $A$ 中的每个 $a$ 映射到 $B$ 中唯一的 $b$，对于 $B$ 中的每个 $b$，都恰好存在一个 $A$ 中的 $a$ 使得 $f(a) = b$（图2.1）。骑手和马匹之间的双射表示每个人都骑一匹马，每匹马都被人骑。这两个函数分别是 rider(horse) 和 horse(rider)。它们互为逆函数。不是双射的函数没有逆函数（图2.2）。
![Figure2.2](pic/Figure2.2.png)
双射的一个例子是 $f : \mathbb{R} \to \mathbb{R}$，其中 $f(x) = x^3$。逆函数是 $f^{-1}(x) = \sqrt[3]{x}$。这个例子表明标准记号可能有些别扭，因为 $x$ 在 $f$ 和 $f^{-1}$ 中都被用作虚拟变量。有时使用不同的虚拟变量会更直观，即 $y = f(x)$ 和 $x = f^{-1}(y)$。这样得到更直观的表示：$y = x^3$ 和 $x = \sqrt[3]{y}$。

没有逆函数的函数例子是 $\text{sqr} : \mathbb{R} \to \mathbb{R}$，其中 $\text{sqr}(x) = x^2$。这有两个原因：首先 $x^2 = (-x)^2$，其次定义域中没有成员映射到目标集的负数部分。注意，如果我们将定义域和值域都限制为 $\mathbb{R}^+$，那么我们可以定义一个逆函数。这时，$\sqrt{x}$ 是一个有效的逆函数。

### 2.1.2 区间

我们经常需要指定函数处理值受限的实数。一种约束方式是指定区间。区间的一个例子是零和一之间的实数，不包括零和一。我们记作 $(0,1)$。因为它不包含端点，这被称为**开区间**。相应的**闭区间**包含其端点，用方括号表示：$[0, 1]$。这种记号可以混合使用；即 $[0, 1)$ 包括零但不包括一。当写区间 $(a, b)$ 时，我们假设 $a \leq b$。表示区间的三种常见方式如图2.3所示。
![Figure2.3](pic/Figure2.3.png)
区间的笛卡尔积经常被使用。例如，为了表示点 $x$ 在三维单位立方体中，我们说 $x \in [0, 1]^3$。

区间与集合运算结合使用特别有用：交集、并集和差集。例如，两个区间的交集是它们共有的点的集合。符号 $\cap$ 用于表示交集。例如，$(3, 5) \cap (4, 6] = [4, 5)$。对于并集，符号 $\cup$ 用于表示任一区间中的点。例如，$[3, 5) \cup (4, 6] = [3, 6]$。与前两个运算符不同，差运算符根据参数顺序产生不同的结果。减号用于差运算符，它返回左区间中不在右区间中的点。例如，$[3, 5) - [4, 6] = [3, 4)$ 和 $[4, 6) - [3, 5) = [5, 6)$。使用区间图来可视化这些运算特别容易（图2.4）。
![Figure 2.4](pic/Figure2-4.png)

### 2.1.3 对数

尽管对数在今天不如计算器出现之前那样普遍，但在处理含有指数项的方程时，对数仍然很有用。根据定义，每个对数都有一个底数 $a$。"以 $a$ 为底的 $x$ 的对数"写作 $\log_a x$，定义为"$a$ 的多少次幂等于 $x$"，即

$$y = \log_a x \Leftrightarrow a^y = x$$

注意，对数底 $a$ 和将 $a$ 升幂的函数互为逆函数。这个基本定义有几个推论：

$$a^{\log_a x} = x$$

$$\log_a (a^x) = x$$

$$\log_a (xy) = \log_a x + \log_a y$$

$$\log_a (x/y) = \log_a x - \log_a y$$

$$\log_a x = \frac{\log_b x}{\log_b a}$$

当我们将微积分应用于对数时，特殊数字 $e = 2.718\ldots$ 经常出现。以 $e$ 为底的对数称为**自然对数**。我们采用常见的简记 $\ln$ 来表示它：

$$\ln x = \log_e x$$

注意，"$\equiv$" 符号可以读作"根据定义等价于"。与虚数单位 $i$ 一样，特殊数字 $e$ 在大量的上下文中出现。许多领域除了 $e$ 之外还使用特定的底数进行运算，并在记号中省略底数，即 $\log x$。例如，天文学家经常使用以10为底的对数，理论计算机科学家经常使用以2为底的对数。由于计算机图形学借鉴了许多领域的技术，我们将避免使用这种简记。

对数和指数的导数说明了为什么自然对数是"自然的"：

$$\frac{d}{dx} \log_a x = \frac{1}{x \ln a}$$

$$\frac{d}{dx} a^x = a^x \ln a$$

上述常数乘数只有当 $a = e$ 时才等于1。

## 2.2 解二次方程

一元二次方程的形式为

$$Ax^2 + Bx + C = 0,$$

其中 $x$ 是实数未知数，$A$、$B$ 和 $C$ 是已知常数。如果你考虑二维 $xy$ 图，其中 $y = Ax^2 + Bx + C$，解就是 $y$ 的"零点"对应的 $x$ 值。因为 $y = Ax^2 + Bx + C$ 是一条抛物线，根据抛物线与 $x$ 轴相离、相切或相交的情况，将有零个、一个或两个实数解（图2.5）。
![Figure 2.5](pic/Figure2-5.png)
为了解析求解二次方程，我们首先除以 $A$：

$$x^2 + \frac{B}{A}x + \frac{C}{A} = 0$$

然后，我们"配方"来组合项：

$$\left(x + \frac{B}{2A}\right)^2 = \frac{B^2}{4A^2} - \frac{C}{A}$$

将常数项移到右边并开方得到：

$$x + \frac{B}{2A} = \pm\sqrt{\frac{B^2}{4A^2} - \frac{C}{A}}$$

两边减去 $\frac{B}{2A}$ 并将分母为 $2A$ 的项合并，得到熟悉的形式：

$$x = \frac{-B \pm \sqrt{B^2 - 4AC}}{2A} \quad (2.1)$$

这里，"$\pm$" 符号表示有两个解，一个取正号，一个取负号。因此，$3 \pm 1$ 等于"2或4"。注意，决定实数解个数的项是

$$D = B^2 - 4AC,$$

它被称为二次方程的**判别式**。如果 $D > 0$，有两个实数解（也称为根）。如果 $D = 0$，有一个实数解（"重根"）。如果 $D < 0$，没有实数解。

例如，$2x^2 + 6x + 4 = 0$ 的根是 $x = -1$ 和 $x = -2$，而方程 $x^2 + x + 1 = 0$ 没有实数解。这些方程的判别式分别是 $D = 4$ 和 $D = -3$，因此我们预期得到相应数量的解。

在程序中，通常最好先计算 $D$，如果 $D$ 为负，则在不开方的情况下返回"无根"。

## 2.3 三角学

### 2.3.1 角

尽管我们对角度有些习以为常，但我们应该回到角度的定义，以便将角度的概念扩展到球面上。角度是由两条半直线（从原点发出的无限射线）或方向形成的，必须使用某种约定来决定它们之间形成的两个可能角度，如图2.6所示。角度由它在单位圆上截取的弧段长度来定义。一种常见的约定是使用较小的弧长，角度的符号由指定两条半直线的顺序决定。使用这种约定，所有角度都在范围 $[-\pi, \pi]$ 内。

![Figure2.6](pic/Figure2-6.png)

这些角度中的每一个都是两个方向"截取"的单位圆弧的长度。因为单位圆的周长是 $2\pi$，两个可能的角度之和为 $2\pi$。这些弧长的单位是**弧度**。另一个常见的单位是**度**，其中圆的周长是 $360°$。因此，$\pi$ 弧度的角度是 $180°$，通常记作 $180°$。度和弧度之间的转换是：

$$\text{度} = \frac{180}{\pi} \cdot \text{弧度}$$

$$\text{弧度} = \frac{\pi}{180} \cdot \text{度}$$

### 2.3.2 三角函数

给定一个直角三角形，其边长分别为 $a$、$o$ 和 $h$，其中 $h$ 是最长边的长度（总是与直角相对），即斜边，一个重要的关系由**勾股定理**描述：

$$a^2 + o^2 = h^2$$

从图2.7可以看出这是正确的，其中大正方形的面积为 $(a+o)^2$，四个三角形的总面积为 $2ao$，中心正方形的面积为 $h^2$。因为三角形和内部正方形均匀地细分了大正方形，我们有 $2ao + h^2 = (a + o)^2$，这很容易操作为上述形式。
![Figure2-7](pic/Figure2-7.png)
我们定义角 $\phi$ 的正弦和余弦，以及其他基于比值的三角函数表达式：

$$\sin \phi = \frac{o}{h}; \quad \csc \phi = \frac{h}{o};$$

$$\cos \phi = \frac{a}{h}; \quad \sec \phi = \frac{h}{a};$$

$$\tan \phi = \frac{o}{a}; \quad \cot \phi = \frac{a}{o}.$$

这些定义允许我们建立**极坐标系**，其中一个点由距离原点的距离和相对于正 $x$ 轴的有符号角度表示（图2.8）。注意约定角度在范围 $\theta \in (-\pi, \pi]$ 内，正角度是从正 $x$ 轴逆时针方向。这种逆时针对应正数的约定是任意的，但在图形学的许多场合都会使用，所以值得记住。
![Figure2-8](pic/Figure2-8.png)
三角函数是周期性的，可以接受任何角度作为参数。例如，$\sin(A) = \sin(A + 2\pi)$。这意味着当考虑定义域为 $\mathbb{R}$ 时，这些函数不可逆。通过限制标准反函数的值域来避免这个问题，这在几乎所有现代数学库中都以标准方式完成（例如，Plauger (1991)）。定义域和值域为：

$$\arcsin : [-1, 1] \rightarrow [-\pi/2, \pi/2];$$

$$\arccos : [-1, 1] \rightarrow [0, \pi]; \quad (2.2)$$

$$\arctan : \mathbb{R} \rightarrow (-\pi/2, \pi/2);$$

$$\text{atan2} : \mathbb{R}^2 \rightarrow (-\pi, \pi].$$

最后一个函数 $\text{atan2}(s, c)$ 通常非常有用。它接受一个与 $\sin A$ 成比例的 $s$ 值和一个按相同因子缩放 $\cos A$ 的 $c$ 值，并返回 $A$。假设该因子为正。理解这个函数的一种方式是，它返回二维笛卡尔坐标点 $(s, c)$ 在极坐标中的角度（图2.9）。
![Figure2-9](pic/Figure2-9.png)

### 2.3.3 常用的等式

#### 位移恒等式（Shifting identities）

$$\sin(-A) = -\sin A$$

$$\cos(-A) = \cos A$$

$$\tan(-A) = -\tan A$$

$$\sin(\pi/2 - A) = \cos A$$

$$\cos(\pi/2 - A) = \sin A$$

$$\tan(\pi/2 - A) = \cot A$$

#### 勾股恒等式（Pythagorean identities）

$$\sin^2 A + \cos^2 A = 1$$

$$\sec^2 A - \tan^2 A = 1$$

$$\csc^2 A - \cot^2 A = 1$$

#### 加法和减法恒等式（Addition and subtraction identities）

$$\sin(A + B) = \sin A \cos B + \sin B \cos A$$

$$\sin(A - B) = \sin A \cos B - \sin B \cos A$$

$$\sin(2A) = 2\sin A \cos A$$

$$\cos(A + B) = \cos A \cos B - \sin A \sin B$$

$$\cos(A - B) = \cos A \cos B + \sin A \sin B$$

$$\cos(2A) = \cos^2 A - \sin^2 A$$

$$\tan(A + B) = \frac{\tan A + \tan B}{1 - \tan A \tan B}$$

$$\tan(A - B) = \frac{\tan A - \tan B}{1 + \tan A \tan B}$$

$$\tan(2A) = \frac{2\tan A}{1 - \tan^2 A}$$

#### 半角恒等式（Half-angle identities）：

$$\sin^2(A/2) = \frac{1 - \cos A}{2}$$

$$\cos^2(A/2) = \frac{1 + \cos A}{2}$$

#### 任意三角形定律

以下恒等式适用于边长为 $a$、$b$、$c$，对应角度分别为 $A$、$B$、$C$ 的任意三角形（图2.10）：

$$\frac{\sin A}{a} = \frac{\sin B}{b} = \frac{\sin C}{c} \quad \text{（正弦定律）}$$

$$c^2 = a^2 + b^2 - 2ab \cos C \quad \text{（余弦定律）}$$

$$\frac{a + b}{a - b} = \frac{\tan\left(\frac{A+B}{2}\right)}{\tan\left(\frac{A-B}{2}\right)} \quad \text{（正切定律）}$$

## 三角形面积

三角形的面积也可以用这些边长来计算：

$$\text{三角形面积} = \frac{1}{4}\sqrt{(a + b + c)(-a + b + c)(a - b + c)(a + b - c)}$$

### 2.3.4 立体角和球面三角学

本节中的传统三角学处理的是平面上的三角形。三角形也可以定义在非平面表面上，其中一个在许多领域（例如天文学）中出现的是单位半径球面上的三角形。这些**球面三角形**的边是球面上大圆（单位半径圆）的弧段。对这些三角形的研究被称为**球面三角学**，在图形学中并不常用，但当它出现时，有时是至关重要的。我们不会在这里讨论其细节，但希望读者知道当这些问题确实出现时，存在相应的理论领域，并且有许多有用的规则，如球面余弦定律和球面正弦定律。关于球面三角学机制的应用示例，可参见关于采样三角形光源（投影到球面三角形）的论文 (Arvo, 1995b)。

对计算机图形学更为核心的重要概念是**立体角**。虽然角度允许我们量化诸如"在我的视野中那两根杆子的分离度是多少"这样的问题，但立体角让我们能够量化诸如"那架飞机覆盖了我视野的多少部分"这样的问题。对于传统角度，我们将杆子投影到单位圆上，并测量它们在单位圆上之间的弧长。我们经常处理角度，以至于我们中的许多人可能会忘记这个定义，因为现在对我们来说这一切都是如此直观。立体角同样简单，但它们可能看起来更令人困惑，因为我们大多数人是在成年后才学习它们的。

对于立体角，我们投影"看到"飞机的可见方向，并将其投影到单位球面上，然后测量面积。这个面积就是立体角，就像弧长是角度一样。虽然角度以**弧度**为单位测量，总和为 $2\pi$（单位圆的总长度），立体角以**球面度（steradians）**为单位测量，总和为 $4\pi$（单位球面的总面积）。

## 2.4 向量

**向量**描述长度和方向。它可以有效地用箭头来表示。如果两个向量具有相同的长度和方向，那么它们就是相等的，即使我们认为它们位于不同的位置（图2.11）。你应该尽可能将向量视为箭头，而不是坐标或数字。在某个时刻，我们必须在程序中将向量表示为数字，但即使在代码中，它们也应该作为对象来操作，只有底层的向量运算才需要了解它们的数值表示 (DeRose, 1989)。向量将用粗体字符表示，例如 $\mathbf{a}$。向量的长度记为 $\|\mathbf{a}\|$。**单位向量**是任何长度为1的向量。**零向量**是长度为零的向量。零向量的方向是未定义的。

向量可以用来表示许多不同的事物。例如，它们可以用来存储**偏移量**，也称为**位移**。如果我们知道"宝藏埋在秘密集合地点向东两步、向北三步的地方"，那么我们知道偏移量，但不知道从哪里开始。向量也可以用来存储**位置**，这是**位置**或**点**的另一个词。位置可以表示为相对于另一个位置的位移。通常，有一个约定的原点位置，所有其他位置都作为相对于该原点的偏移量来存储。

需要注意的是，**位置不是向量**。正如我们将要讨论的，你可以将两个向量相加。然而，将两个位置相加通常没有意义，除非它是计算位置加权平均时的中间运算 (Goldman, 1985)。将两个偏移量相加确实有意义，这也是偏移量是向量的一个原因。但这强调了位置不是偏移量；它是相对于特定原点位置的偏移量。偏移量本身并不是位置。

### 2.4.1 向量操作

向量具有我们与实数相关联的大多数常用算术运算。当且仅当两个向量具有相同的长度和方向时，它们才相等。两个向量根据**平行四边形法则**相加。该法则规定，两个向量的和是通过将其中一个向量的尾部放在另一个向量的头部来求得的（图2.12）。和向量是"完成三角形"的向量，该三角形由这两个向量开始形成。平行四边形是通过以任一顺序求和形成的。这强调了向量加法具有**交换律**：

$$\mathbf{a} + \mathbf{b} = \mathbf{b} + \mathbf{a}$$

注意，平行四边形法则只是形式化了我们对位移的直觉。想象沿着一个向量从尾到头走，然后沿着另一个向量走。净位移就是平行四边形的对角线。你也可以为向量创建一个**一元负号**：$-\mathbf{a}$（图2.13）是一个与 $\mathbf{a}$ 长度相同但方向相反的向量。这允许我们也定义减法：

$$\mathbf{b} - \mathbf{a} = -\mathbf{a} + \mathbf{b}$$

你可以用平行四边形来可视化向量减法（图2.14）。我们可以写出：

$$\mathbf{a} + (\mathbf{b} - \mathbf{a}) = \mathbf{b}$$

向量也可以相乘。实际上，有几种涉及向量的乘积。首先，我们可以通过将向量乘以实数 $k$ 来**缩放**向量。这只是改变向量的长度而不改变其方向。例如，$3.5\mathbf{a}$ 是一个与 $\mathbf{a}$ 方向相同的向量，但它的长度是 $\mathbf{a}$ 的3.5倍。我们将在本节后面讨论两种涉及两个向量的乘积：**点积**和**叉积**，以及在第6章中讨论涉及三个向量的乘积：**行列式**。

![Figue2-12](pic/Figure2-12.png)

### 2.4.2 笛卡尔坐标系下的向量

一个2D向量可以写成任意两个非零且不平行向量的组合。这两个向量的这种性质称为**线性无关**。两个线性无关的向量构成一个**2D基底**，因此这些向量被称为**基向量**。例如，向量 $\mathbf{c}$ 可以表示为两个基向量 $\mathbf{a}$ 和 $\mathbf{b}$ 的组合（图2.15）：

$$\mathbf{c} = a_c\mathbf{a} + b_c\mathbf{b}$$

注意权重 $a_c$ 和 $b_c$ 是唯一的。如果两个向量是**正交的**（即它们彼此成直角），基底就特别有用。如果它们同时也是单位向量，这种情况下它们是**标准正交的**，则更加有用。如果我们假设已知两个这样的"特殊"向量 $\mathbf{x}$ 和 $\mathbf{y}$，那么我们可以用它们在**笛卡尔坐标系**中表示所有其他向量，其中每个向量都用两个实数来表示。例如，向量 $\mathbf{a}$ 可以表示为：

$$\mathbf{a} = x_a\mathbf{x} + y_a\mathbf{y}$$

其中 $x_a$ 和 $y_a$ 是2D向量 $\mathbf{a}$ 的实数笛卡尔坐标（图2.16）。注意这在概念上与方程(2.3)并没有真正的不同，其中基向量不是标准正交的。但笛卡尔坐标系有几个优势。例如，根据**勾股定理**，$\mathbf{a}$ 的长度为：

$$\|\mathbf{a}\| = \sqrt{x_a^2 + y_a^2}$$

## 2.9 三角形

2D 三角形面积：$A = \frac{1}{2} \begin{vmatrix} x_b-x_a & x_c-x_a \\ y_b-y_a & y_c-y_a \end{vmatrix}$，abc 三点逆时针排列时 A 为正，反之为负。
2D 三角形内的点：$P = \alpha a+\beta b+ \gamma c\quad where \quad \alpha+\beta+\gamma = 1 \quad  \alpha, \beta, \gamma \lt 1$

> 重心坐标（Barycentric coordinates）和你想的不太一样。。。

> 对于空间三角形 P1P2P3 内任一点 P，必定唯一存在三个数 w1,w2,w3，满足：w1+w2+w3=1
> P=w1*P1+w2*P2+w3\*P3 （即 P 表示成 P1,P2,P3 的线性组合）
> 则(w1,w2,w3)就称为此三角形上 P 点的（归一化）重心坐标（Barycentric coordinates）。

重心坐标的分量越接近 1，表示支点 p 越远离分量的对边。

## 2.12 蒙特卡罗积分

采样，采样得越多计算出来越接近积分真值。

> PDF：probability density function 概率密度函数
> Cumulative Distribution Function, CDF 累计分布函数

### 2.12.1 重要性采样

公式化打法：

1. 确定采样得函数与定义域
2. 确定一个随机生成采样点得算法，同时确定采样点的概率密度函数
3. 计算${f(x_i)}\, / \,{p(x_i)}$的均值

> [!note] 蒙特卡洛积分的正确性说明
> $$E(I) = E\big(\frac{1}{n}\sum_{k=1}^n \frac{f(X_k)}{pdf()X_k}\big)$$ > $$E(I) = \frac{1}{n}\sum_{k=1}^n E\big(\frac{f(X_k)}{pdf()X_k}\big)$$ > $$E(I) = \frac{1}{n}\sum_{k=1}^n E\big(\int \frac{f(x)}{pdf(x)} \cdot pdf(x)\,dx\big)$$ > $$E(I) = \frac{1}{n}\sum_{k=1}^n \int f(x)\,dx$$ > $$E(I) = \int f(x)\,dx$$

> 上式说明蒙特卡洛积分是无偏的
> 另外蒙特卡洛积分的方差是：$D(I)\propto \frac{1}{\sqrt{n}}$
> 顺带一提，写程序的时候先置 pdf 为均匀采样，为了方便调试。
